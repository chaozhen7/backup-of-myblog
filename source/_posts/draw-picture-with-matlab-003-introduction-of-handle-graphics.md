layout: post
title: matlab 画图（三）： 图形句柄
date: 2016-4-14 13:20:22
tags: 
   - Matlab
   - 画图
comments: true
copyright: true
toc: true
---

当你用作图命令时，MATLAB用多种图形对象创建图形，例如线，文本，表面。所有图形对象都有控制其性能的属性。你可以在MATLAB中询问每种属性的取值并设置大部分的属性值。

每当MATLAB创建一个图形对象时，它就给该对象赋以一个标识符（称为句柄）。可以用此句柄访问对象属性。若你想作下列操作，句柄图形很有用：
- 修改图形外观。
- 通过编写能直接创建和操作对象的M-文件以创建自定义作图命令。

<!--more-->

## **1. 图形对象** ##

图形对象是用以显示图形和用户界面元素的基本元素。下表列出了各种图形对象。
 
|  对象 |   描述  |
|:---:|:----|
|  Root |  对计算机屏幕最高级的对象   |
|  Figure |  用来显示图形和用户界面的窗口    |
|  Axes |  在窗口中显示图形的轴    |
|  Uicontrol |  用户界面控制。执行一个对用户交互作用的函数。   |
|  Uimenu|   用户定义窗口菜单   |
|  Uicontextmenu |  右键单击对象时弹出的菜单   |
|  Image |  二维像素基础图    |
|  Light |  影响斑点和表面对象着色的光源    |
|  Line |  用于诸如plot, plot3, semilogx等函数的线    |
|  Patch |  带边缘的填充多边形    |
|  Rectangle |  二维形状，从矩形到椭圆    |
|  Surface |  由x-y平面以上的数据值所作图创建的矩阵数据的三维表示    |
|  Text |  字符串   |
 
### **1.1 对象级别** ###

不同对象分布在一个树形结构级别里，反映它们的独立性。例如，线对象是在轴对象的框架下的。依次，轴对象只存在于figure对象中。以下图表阐明了这种树形结构。

![](/img/articles/matlab/matlab-pic-003-1.jpg)

### **1.2 创建对象** ###

每个对象都有一个创建用的关联函数。这些函数与所创对象有相同名称。例如，text 函数创立文本对象，figure 函数创立 figure 窗口对象，等等。MATLAB的高级别的图形函数（例如plot和surf）会调用适当的低级别函数来作出它们各自的图形。对象创建函数与对象有相同名称。例如，创立轴的函数是axes 。


### **1.3 用对象操作的命令** ###

下表列出了操作对象常用的命令。

|  函数 |   目的  |
|:---:|:---|
|  copyobj |   复制图形对象   |
|  delete |  删除对象   |
|  findobj |   查找具有指定属性值的对象句柄    |
|  gca |   返回当前轴的句柄    |
|  gcf |   返回当前窗口的句柄    |
|  gco |   返回当前对象的句柄   |
|  get |  询问对象属性值   |
|  set |   设置对象属性值   | 

## **2. 设定对象属性** ##

所有对象属性都有默认值。然而，改变一些属性设置以定制图形可能有用。有两个途径可以设定对象属性：
- 创建对象时指定属性值。 
- 在现有的对象中设置属性值 

### **2.1 从作图命令设定属性** ###

类似作图函数，在诸如 `plot`, `mesh`, 和 `surf` 的创建对象用的函数也可以指定对象属性值为变元。 

例如，可以用创建线或表面的作图命令来指定属性名称和属性值为二元变元。命令
```matlab
plot(x,y,'LineWidth',1.5)
```
以 x 和 y 为变元作出数据图，用到具有 LineWidth 属性且设为1.5点（1点=1/72英寸）的线。可以用此法设定任何线对象。 

### **2.2 设定现有对象的属性** ###

要修改现有对象属性值，可以用 `set` 命令，如若作图编辑模式已打开，则可用属性编辑器。属性编辑器对许多对象属性提供图形用户界面。

很多作图命令可以返回所建对象的句柄，这样你可以用 set 命令修改对象。例如，下列语句创立一个5*5矩阵（创立5行，每行一列），然后设置 Marker 为正方形并设 MarkerFaceColor 为绿色。 
```matlab
h = plot(magic(5));
set(h,'Marker','s',MarkerFaceColor','g')
```
在此情形下，h是一个包含5个句柄的向量，每个句柄代表图形中五行之一。语句 set 设置每一行的Marker 和 MarkerFaceColor 为同一个值。

### **2.3 设置多个属性值** ###

若要对每条线的属性设置另一个值，可以用单元数组来储存所有数据并把它传给 set 命令。例如，创建一幅图并保存线句柄。
```matlab
h = plot(magic(5));
```
假如要对每条线添加不同的标记并对标记外观填上与线相同的颜色，则须定义两个单元数组，一个包含属性名，另一个则包含想设的属性值。 

单元数组prop_name包含两个元素。
```matlab
prop_name(1) = {'Marker'};
prop_name(2) = {'MarkerFaceColor'};
```
prop_values 单元数组包含10个值-5个表示表示Marker标记属性，另5个表示MarkerFaceColor属性。注意prop_values是一个二维单元数组。第一维表示不同值赋给h中的哪个句柄，第二维表示值赋给哪个属性。 
```matlab
prop_values(1,1) = {'s'};
prop_values(1,2) = {get(h(1),'Color')};
prop_values(2,1) = {'d'};
prop_values(2,2) = {get(h(2),'Color')};
prop_values(3,1) = {'o'};
prop_values(3,2) = {get(h(3),'Color')};
prop_values(4,1) = {'p'};
prop_values(4,2) = {get(h(4),'Color')};
prop_values(5,1) = {'h'};
prop_values(5,2) = {get(h(5),'Color')};
```
MarkerFaceColor 总是把值赋给对应的线的颜色的（该颜色通过用get命令设置线的Color（颜色）属性得到）。

定义了单元数组后，调用set命令来指定新的属性值。
```matlab
set(h,prop_name,prop_values)
```

![](/img/articles/matlab/matlab-pic-003-2.jpg)


## **3. 查找现有的对象句柄** ##

用命令 `findobj` 可以通过搜索带特定属性值的对象得到图形对象的句柄。用 findobj，可以指定任何属性组合的值，这样要从多个对象选出一个就变的容易。例如，可能需要找出带有正方标记蓝色外观的蓝线。

也可以指定搜索哪个图形或轴。以下各节提供示例阐述如何用findobj命令。

### **3.1 查找所有某类型的对象** ###

由于所有对象都具有一个用来辨别类型的类型属性，你可以查找所有某特定类型对象事件的句柄。例如，
```maltab
h = findobj('Type','line');
```

查找所有线对象的句柄。 

### **3.2 查找某特定属性的对象** ###

可以指定多个属性以缩窄搜索范围，例如，
```matlab
h = findobj('Type','line','Color','r','LineStyle',':');
```

查找所有红色点线的句柄。

### **3.3 限制搜索范围** ###


可以在通过把开始的图形或轴的句柄作为第一变元给对象等级指定开始点，例如，
```matlab
h = findobj(gca,'Type','text','String','\pi/2');
```
只在当前轴下查找字符串 π/2 。

### **3.4 把findobj用作变元** ###

由于findobj返回所找到的句柄，你可以用它来替换句柄变元，例如，

```matlab
set(findobj('Type','line','Color','red'),'LineStyle',':')
```

找出所有红线及设定线型为点线。 


